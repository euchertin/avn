<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ê–¥–º–∏–Ω–∫–∞ –∑–∞—è–≤–æ–∫ | –ê–í–ù</title>
  <link rel="stylesheet" href="css/index.css" />
  <link rel="stylesheet" href="css/country.css" />
  <link rel="icon" href="logo.svg" type="image/svg+xml" />
  <style>
  * {
   font-family: 'Futura', sans-serif;
}

    /* –¢–≤–æ–π —Å—Ç–∏–ª—å –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ ‚Äî –Ω–µ —Ç—Ä–æ–≥–∞–µ–º */
    .application {
      background-color: #1a1a1a;
      border-radius: 16px;
      box-shadow: 0 0 25px rgba(0,0,0,0.6);
      margin-bottom: 40px;
      padding: 30px;
      font-family: 'Futura', sans-serif;
      color: #fff;
    }
    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    .app-header > div {
      font-size: 22px;
      font-weight: 600;
    }
    .btns {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }
    button {
      cursor: pointer;
      border-radius: 20px;
      border: none;
      padding: 12px 28px;
      font-size: 18px;
      font-family: 'Futura', sans-serif;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button.approve {
      background-color: #28a745;
      color: white;
    }
    button.approve:disabled {
      background-color: #555;
      cursor: not-allowed;
    }
    button.reject {
      background-color: #dc3545;
      color: white;
    }
    button:hover:not(:disabled) {
      filter: brightness(1.15);
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è */
    #auth-wrapper {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 9999;
      color: #eee;
      font-family: 'Futura', sans-serif;
      padding: 20px;
    }
    #auth-wrapper input[type="password"] {
      font-size: 24px;
      padding: 12px 20px;
      border-radius: 8px;
      border: none;
      margin-top: 15px;
      width: 250px;
      background: #222;
      color: #eee;
      outline: none;
      box-sizing: border-box;
    }
    #auth-wrapper button {
      margin-top: 20px;
      padding: 12px 32px;
      font-size: 20px;
      border-radius: 8px;
      border: none;
      background-color: #28a745;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #auth-wrapper button:hover {
      background-color: #218838;
    }
    #auth-error {
      margin-top: 15px;
      color: #dc3545;
      font-weight: 700;
      min-height: 24px;
    }

    /* –°–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω–∫—É –ø–æ–∫–∞ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω */
    #admin-content {
      display: none;
    }
    .password-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  gap: 10px;
}

#passwordInput {
  padding: 10px;
  font-size: 18px;
  border-radius: 10px;
  border: none;
  outline: none;
  flex: 1;
}

#togglePassword {
  padding: 10px;
  border: none;
  background: #333;
  color: #fff;
  border-radius: 10px;
  cursor: pointer;
}

  </style>
</head>
<body>

<header>
  <div class="container">
    <nav id="navigation">
      <img src="logo.svg" alt="–õ–æ–≥–æ—Ç–∏–ø —Å–∞–π—Ç–∞" class="logo" width="65px" />
      <a aria-label="mobile menu" class="nav-toggle">
        <span></span>
        <span></span>
        <span></span>
      </a>
      <div class="menu-links menu">
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="map.html">–ö–∞—Ä—Ç–∞</a>
        <a href="countries.html">–°—Ç—Ä–∞–Ω—ã</a>
        <a href="reg.html">–í—Å—Ç—É–ø–∏—Ç—å</a>
        <a href="time.html">–í—Ä–µ–º—è</a>
      </div>
      <div class="vk-link">
        <a href="https://vk.com/avncommunity"><img src="images/vk1.svg" alt="VK Button Logo" class="vk-logo vk-small" width="50px" /></a>
      </div>
    </nav>
  </div>
</header>

<!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
<div id="auth-wrapper">
  <h1>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ</h1>
  <div class="password-wrapper">
  <input type="password" id="password-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
  <button type="button" id="togglePassword">üëÅ</button>
</div>

  
  <button id="submit-password">–í–æ–π—Ç–∏</button>
  <div id="auth-error"></div>
</div>


<!-- –°–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç –∞–¥–º–∏–Ω–∫–∏ -->
<div id="admin-content" class="container" style="max-width:1400px; margin: 80px auto; padding: 0 20px;">
  <h1 style="color:#fff; font-family: 'Futura', sans-serif; margin-bottom: 40px;">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
  <div id="applications-list">
    <p style="color:#bbb;">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...</p>
  </div>
</div>

<footer>
  <div class="footer-logo"><img src="logo.svg" alt="–õ–æ–≥–æ—Ç–∏–ø –ø—Ä–æ–µ–∫—Ç–∞" /></div>
  <div class="footer-links">
    <p>‚ùó–ü—Ä–æ–µ–∫—Ç –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–ª—ã –∏ –Ω–µ —Å—Ç–∞–≤–∏—Ç —Å–≤–æ–µ–π —Ü–µ–ª—å—é —á—Ç–æ-–ª–∏–±–æ –∏–∑ –ø–æ–ª–∏—Ç–∏–∫–∏. –û–Ω –ø–æ–¥—á–∏—Å—Ç—É—é —è–≤–ª—è–µ—Ç—Å—è –≤—ã–¥—É–º–∫–æ–π –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∂–µ–ª–∞—é—â–∏–º–∏ —ç—Ç–æ–≥–æ –ª—é–¥—å–º–∏.</p>
    <p>‚ùó–ú—ã –≤—ã—Å—Ç—É–ø–∞–µ–º –≤ —Ä–æ–ª–∏ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞ –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–π –≤–ª–∞—Å—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø—ã, –Ω–æ –Ω–µ –∑–∞ –µ—ë –ø—Ä–µ–¥–µ–ª–∞–º–∏. –ú—ã –Ω–µ –Ω–µ—Å—ë–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –≤—Å—ë, —á—Ç–æ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤–Ω–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –í–ö –∏ —Å–∞–π—Ç–∞.</p>
  </div>
  <div class="footer-socials">
    <a href="https://vk.com/avncommunity"><img src="images/vk1.svg" alt="VK" /></a>
  </div>
  <div class="footer-copy">
    <p>¬© 2025 –ï–≤–≥–µ–Ω–∏–π –ß–µ—Ä—Ç–∏–Ω. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </div>
</footer>

<script>
  // –ü—Ä–æ—Å—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî –ø–∞—Ä–æ–ª—å "–∞–≤–Ω–∫—Ä—É—Ç–æ–π"
  const PASSWORD = "–∞–≤–Ω–∫—Ä—É—Ç–æ–π";

  const authWrapper = document.getElementById("auth-wrapper");
  const adminContent = document.getElementById("admin-content");
  const input = document.getElementById("password-input");
  const btn = document.getElementById("submit-password");
  const errorDiv = document.getElementById("auth-error");

  btn.addEventListener("click", () => {
    const val = input.value.trim();
    if (val === PASSWORD) {
      // –°–∫—Ä—ã—Ç—å —ç–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è, –ø–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω–∫—É
      authWrapper.style.display = "none";
      adminContent.style.display = "block";

      // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∞–¥–º–∏–Ω–∫–∏: —Ç.–∫. –æ–Ω —É —Ç–µ–±—è –≤ –º–æ–¥—É–ª–µ, –æ–Ω —Å–∞–º –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç—Å—è
      // –ó–¥–µ—Å—å –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–¥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å, —Ç.–∫. –º–æ–¥—É–ª—å –∂–¥—ë—Ç DOMContentLoaded,
      // –∞ —Å–µ–π—á–∞—Å –æ–Ω —É–∂–µ –Ω–∞—Å—Ç—É–ø–∏–ª, –ø–æ—ç—Ç–æ–º—É –∫–æ–¥ –∞–¥–º–∏–Ω–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è.

    } else {
      errorDiv.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!";
      input.value = "";
      input.focus();
    }
  });

  // –ü–æ–∑–≤–æ–ª–∏–º Enter –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
  input.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      btn.click();
    }
  });
</script>

<!-- –¢–≤–æ–π —Å–∫—Ä–∏–ø—Ç –∞–¥–º–∏–Ω–∫–∏, –æ—Å—Ç–∞–≤–ª–µ–Ω –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
  import {
    getFirestore, collection, getDocs, updateDoc, deleteDoc, doc, query, orderBy
  } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD1mSa0TpadaUqX5QxNoHaCJWWuJ8sXeLM",
    authDomain: "vgovernments-6c294.firebaseapp.com",
    projectId: "vgovernments-6c294",
    storageBucket: "vgovernments-6c294.appspot.com",
    messagingSenderId: "795317676699",
    appId: "1:795317676699:web:af8649e04af6216d14743e"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const applicationsList = document.getElementById("applications-list");

  function createApplicationCard(id, data) {
    const appDiv = document.createElement("div");
    appDiv.className = "application";

    appDiv.innerHTML = `
      <div class="form-grid">
        <div class="left-column">
          <div class="upload-wrapper">
            <label class="upload-label">–§–ª–∞–≥</label>
            <div class="flag-field">
              <img src="${data.flagUrl || 'images/default-flag.jpg'}" alt="–§–ª–∞–≥ —Å—Ç—Ä–∞–Ω—ã" />
            </div>
          </div>
          <p><strong>–§–æ—Ä–º–∞ –ø—Ä–∞–≤–ª–µ–Ω–∏—è:</strong> ${data.ruleForm || "‚Äî"}</p>
          <p><strong>–†–µ–ª–∏–≥–∏—è:</strong> ${data.religion || "‚Äî"}</p>
          <p><strong>–ù–∞—Å–µ–ª–µ–Ω–∏–µ:</strong> ${data.population || "‚Äî"}</p>
          <p><strong>–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ:</strong> ${data.recognition || "‚Äî"}</p>
        </div>
        <div class="right-column">
          <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
          <p style="white-space: pre-wrap;">${data.description || "–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è."}</p>
          <div class="photo-pair" style="margin-top: 20px;">
            <div class="centerphoto">
              <div class="upload-wrapper">
                <label class="upload-label">–ü—Ä–∞–≤–∏—Ç–µ–ª—å</label>
                <div class="photo-field">
                  <img src="${data.rulerPhotoUrl || 'images/default-avatar.jpg'}" alt="–§–æ—Ç–æ –ø—Ä–∞–≤–∏—Ç–µ–ª—è" />
                </div>
                <div class="phototext">
                  <p>${data.rulerName || "‚Äî"}</p>
                </div>
              </div>
            </div>
            <div class="centerphoto">
              <div class="upload-wrapper">
                <label class="upload-label">–í–∞–ª—é—Ç–∞</label>
                <div class="valuta-field">
                  <img src="${data.currencyPhotoUrl || 'images/default-currency.jpg'}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∞–ª—é—Ç—ã" />
                </div>
                <div class="valuta-text">
                  <p>${data.currencyName || "‚Äî"}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="app-header" style="margin-top: 30px; justify-content: flex-start;">
        <div><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status">${data.status}</span></div>
        <div class="btns" style="margin-left: auto;">
          <button class="approve" ${data.status === "approved" ? "disabled" : ""}>–ü—Ä–∏–Ω—è—Ç—å</button>
          <button class="reject">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
        </div>
      </div>
    `;

    const approveBtn = appDiv.querySelector("button.approve");
    const rejectBtn = appDiv.querySelector("button.reject");
    const statusSpan = appDiv.querySelector(".status");

    approveBtn.addEventListener("click", async () => {
      try {
        await updateDoc(doc(db, "applications", id), { status: "approved" });
        statusSpan.textContent = "approved";
        approveBtn.disabled = true;
        alert("–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞");
      } catch (e) {
        alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞");
        console.error(e);
      }
    });

    rejectBtn.addEventListener("click", async () => {
      if (!confirm("–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫—É?")) return;
      try {
        await deleteDoc(doc(db, "applications", id));
        appDiv.remove();
        alert("–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ –∏ —É–¥–∞–ª–µ–Ω–∞");
      } catch (e) {
        alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏");
        console.error(e);
      }
    });

    return appDiv;
  }

  async function loadApplications() {
    applicationsList.innerHTML = '<p style="color:#bbb;">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...</p>';
    try {
      const q = query(collection(db, "applications"), orderBy("timestamp", "desc"));
      const querySnapshot = await getDocs(q);
      applicationsList.innerHTML = "";

      if (querySnapshot.empty) {
        applicationsList.innerHTML = "<p>–ó–∞—è–≤–æ–∫ –Ω–µ—Ç</p>";
        return;
      }

      querySnapshot.forEach(docSnap => {
        const id = docSnap.id;
        const data = docSnap.data();
        const appCard = createApplicationCard(id, data);
        applicationsList.appendChild(appCard);
      });
    } catch (err) {
      applicationsList.innerHTML = "<p>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫</p>";
      console.error(err);
    }
  }

  document.getElementById("togglePassword").addEventListener("click", () => {
  const input = document.getElementById("password-input");
  const isPassword = input.type === "password";
  input.type = isPassword ? "text" : "password";
});

</script>

<script src="js/index.js"></script>

</body>
</html>
